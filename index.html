<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üõ¢Ô∏è Monitor Stok LPG Agen</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="text-center mb-4">üõ¢Ô∏è Monitor Stok LPG Agen</h1>
    <div id="stok-container" class="table-responsive"></div>
  </div>

  <script>
    async function fetchStok() {
      const container = document.getElementById('stok-container');
      container.innerHTML = '<p>Memuat data stok...</p>';

      try {
        const response = await fetch('http://84.247.174.222:5000/api/stok'); // Ganti IP ini jika perlu
        const data = await response.json();

        if (Object.keys(data).length === 0) {
          container.innerHTML = '<p>Belum ada data stok tersimpan.</p>';
          return;
        }

        let html = `
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>No</th>
                <th>No HP / Email</th>
                <th>Stok LPG 3kg</th>
                <th>Waktu Update</th>
              </tr>
            </thead>
            <tbody>
        `;

        let i = 1;
        for (const [akun, info] of Object.entries(data)) {
          html += `
            <tr>
              <td>${i++}</td>
              <td>${akun}</td>
              <td>${info.stok}</td>
              <td>${info.waktu}</td>
            </tr>
          `;
        }

        html += '</tbody></table>';
        container.innerHTML = html;
      } catch (error) {
        container.innerHTML = '<p class="text-danger">Gagal mengambil data stok. Pastikan server aktif dan IP benar.</p>';
        console.error(error);
      }
    }

    fetchStok();
    setInterval(fetchStok, 30000); // auto refresh tiap 30 detik
  </script>
</body>
</html>

